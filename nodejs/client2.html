<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat</title>

    <style>
        #chatLog {
            resize: none;
            width: 430px;
            height: 480px;
        }

        #chat {
            margin-top: 20px;
        }

        #message {
            width: 420px;
            height: 30px;
            padding-left: 10px;
        }

        #submit {
            width: 100%;
            height: 30px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
<div>
    <textarea id="chatLog" class="chat_log" readonly></textarea>
    <form id="chat">
        <input id="name" class="name" type="hidden" readonly>
        <input id="message" class="message" type="text" placeholder="내용을 입력해 주세요." autocomplete="off">
        <input id="submit" type="submit" class="chat" value="send"/>
    </form>
    <div id="box" class="box">
        <script src="/socket.io/socket.io.js"></script> <!-- 1 -->
        <script src="//code.jquery.com/jquery-1.11.1.js"></script>
        <script>
            var socket = io(); //1
            var Room;
            $('#chat').on('submit', function(e){ //2
                socket.emit('send message', $('#name').val(), $('#message').val());
                $('#message').val('');
                $('#message').focus();
                e.preventDefault();
            });
            socket.on('receive message', function(msg){ //3
                $('#chatLog').append(msg+'\n');
                $('#chatLog').scrollTop($('#chatLog')[0].scrollHeight);
            });
            socket.on('change name', function(name){ //4
                $('#name').val(name);
            });

            // RoomId 받기
            socket.on('RoomId',function (data) {
                Room = data;
                // RoomId 보내기
                socket.emit('joinRoom',Room);
            });


        </script>
</div>
</body>
</html>